<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PuriClor – Tratamiento profesional del agua</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .header-nav {
      transition: background-color 0.3s ease, box-shadow 0.3s ease, backdrop-filter 0.3s ease, transform 0.3s ease;
    }
    .header-nav.nav-hidden {
      transform: translateY(-100%);
    }
    .header-nav.nav-scrolled {
      background-color: rgba(255, 255, 255, 0.95);
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.08), 0 2px 4px -2px rgba(0, 0, 0, 0.05);
      backdrop-filter: blur(8px);
    }
    .header-nav .nav-text {
      color: #fff;
      text-shadow: 0 0 12px rgba(59, 130, 246, 0.9), 0 0 24px rgba(59, 130, 246, 0.5);
    }
    .header-nav .nav-cta {
      color: #fff;
      text-shadow: 0 0 12px rgba(59, 130, 246, 0.9), 0 0 24px rgba(59, 130, 246, 0.5);
      box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.5), 0 0 16px rgba(59, 130, 246, 0.4);
    }
    .header-nav .nav-cta:hover {
      box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.7), 0 0 20px rgba(59, 130, 246, 0.6);
    }
    .header-nav.nav-scrolled .nav-text {
      color: #1f2937;
      text-shadow: none;
    }
    .header-nav.nav-scrolled .nav-text:hover {
      color: #111827;
    }
    .header-nav.nav-scrolled .nav-cta {
      color: #1f2937;
      text-shadow: none;
      box-shadow: 0 0 0 1px rgba(209, 213, 219, 0.9);
    }
    .header-nav.nav-scrolled .nav-cta:hover {
      box-shadow: 0 0 0 1px #1f2937;
    }
    .nav-link {
      position: relative;
    }
    .nav-link::after {
      content: '';
      position: absolute;
      bottom: -2px;
      left: 0;
      width: 0;
      height: 1px;
      background-color: currentColor;
      transition: width 0.25s ease;
    }
    .nav-link:hover::after {
      width: 100%;
    }
    .hero-bg {
      background-size: cover;
      background-position: center center;
      background-repeat: no-repeat;
      background-color: #9dc9dc;
    }
    .hero-wave {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 320px;
      z-index: 5;
      overflow: hidden;
      pointer-events: none;
    }
    .hero-wave svg {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 200%;
      height: 100%;
      min-width: 100%;
    }
    .hero-wave__layer1 {
      animation: hero-wave-drift 8s linear infinite;
    }
    .hero-wave__layer2 {
      opacity: 0.72;
      animation: hero-wave-drift 10s linear infinite;
    }
    @keyframes hero-wave-drift {
      0% { transform: translateX(0); }
      100% { transform: translateX(-50%); }
    }
    #hero-3d {
      position: relative;
      width: 100%;
      min-height: 380px;
      height: 45vh;
      z-index: 5;
      pointer-events: none;
    }
    #hero-3d canvas {
      display: block;
      width: 100% !important;
      height: 100% !important;
      pointer-events: none;
    }
  </style>
</head>
<body class="antialiased bg-slate-50">
  <!-- Navigation (Tesla-style: transparent at top, solid + blur on scroll) -->
  <header id="headerNav" class="header-nav fixed top-0 left-0 right-0 z-50 bg-transparent">
    <nav class="mx-auto flex max-w-7xl items-center justify-between px-4 py-3 sm:px-6 lg:px-8">
      <a href="#inicio" class="nav-text text-lg font-bold tracking-tight transition-colors duration-300">PuriClor</a>
      <ul class="hidden items-center gap-8 sm:flex">
        <li><a href="#inicio" class="nav-link nav-text text-sm font-medium transition-colors duration-300">Inicio</a></li>
        <li><a href="#soluciones" class="nav-link nav-text text-sm font-medium transition-colors duration-300">Soluciones</a></li>
        <li><a href="#productos" class="nav-link nav-text text-sm font-medium transition-colors duration-300">Productos</a></li>
        <li><a href="#analisis" class="nav-link nav-text text-sm font-medium transition-colors duration-300">Análisis</a></li>
        <li><a href="#contacto" class="nav-link nav-text text-sm font-medium transition-colors duration-300">Contacto</a></li>
      </ul>
      <a href="#contacto" class="nav-cta nav-text inline-flex items-center rounded px-4 py-2 text-sm font-medium transition-colors duration-300">Cotizar</a>
    </nav>
  </header>
  <script>
    (function() {
      var SCROLL_THRESHOLD = 50;
      var SCROLL_DELTA = 8;
      var header = document.getElementById('headerNav');
      var scrolled = false;
      var hidden = false;
      var lastScrollY = window.scrollY;
      function onScroll() {
        var y = window.scrollY;
        var nowScrolled = y >= SCROLL_THRESHOLD;
        if (nowScrolled !== scrolled) {
          scrolled = nowScrolled;
          header.classList.toggle('nav-scrolled', scrolled);
        }
        if (y <= SCROLL_THRESHOLD) {
          if (hidden) {
            hidden = false;
            header.classList.remove('nav-hidden');
          }
        } else {
          if (y > lastScrollY && y - lastScrollY > SCROLL_DELTA) {
            if (!hidden) {
              hidden = true;
              header.classList.add('nav-hidden');
            }
          } else if (y < lastScrollY && lastScrollY - y > SCROLL_DELTA) {
            if (hidden) {
              hidden = false;
              header.classList.remove('nav-hidden');
            }
          }
        }
        lastScrollY = y;
      }
      window.addEventListener('scroll', onScroll, { passive: true });
      onScroll();
    })();
  </script>

  <!-- Hero Section -->
  <section id="inicio" class="relative min-h-screen flex flex-col pb-24">
    <div class="absolute inset-0 hero-bg" style="background-image: url('../assets/pul.png');"></div>
    <div class="absolute inset-0 bg-black/10"></div>

    <!-- Text: centered, full width, above 3D -->
    <div class="relative z-10 flex w-full flex-col items-center justify-center px-4 pt-28 pb-8 text-center sm:pt-32 md:pt-36" style="pointer-events:auto">
      <h1 class="max-w-5xl text-4xl font-bold tracking-tight text-white drop-shadow-lg sm:text-5xl md:text-6xl lg:text-7xl">
        Aprovecha al máximo tu piscina
      </h1>
      <p class="mx-auto mt-4 max-w-2xl text-lg text-white/90 drop-shadow sm:text-xl">
        Agua cristalina y segura con tratamiento profesional.
      </p>
    </div>

    <!-- 3D container: below text, full width -->
    <div id="hero-3d" class="flex-1"></div>

    <!-- SVG wave: two layers, gradient, seamless loop -->
    <div class="hero-wave" aria-hidden="true">
      <svg class="hero-wave__layer1" viewBox="0 0 1200 80" preserveAspectRatio="none">
        <defs>
          <linearGradient id="heroWaveGrad1" x1="0%" y1="0%" x2="0%" y2="100%">
            <stop offset="0%" stop-color="#ffffff" stop-opacity="0.98" />
            <stop offset="100%" stop-color="#f8fafc" stop-opacity="0.95" />
          </linearGradient>
        </defs>
        <path fill="url(#heroWaveGrad1)" d="M0 48 C200 18 400 72 600 48 C800 24 1000 72 1200 48 L1200 80 L0 80 Z M1200 48 C1400 18 1600 72 1800 48 C2000 24 2200 72 2400 48 L2400 80 L1200 80 Z"/>
      </svg>
      <svg class="hero-wave__layer2" viewBox="0 0 1200 80" preserveAspectRatio="none">
        <defs>
          <linearGradient id="heroWaveGrad2" x1="0%" y1="0%" x2="0%" y2="100%">
            <stop offset="0%" stop-color="#ffffff" stop-opacity="0.98" />
            <stop offset="100%" stop-color="#f8fafc" stop-opacity="0.95" />
          </linearGradient>
        </defs>
        <path fill="url(#heroWaveGrad2)" d="M0 52 C180 28 420 68 600 52 C780 36 1020 68 1200 52 L1200 80 L0 80 Z M1200 52 C1380 28 1620 68 1800 52 C1980 36 2220 68 2400 52 L2400 80 L1200 80 Z"/>
      </svg>
    </div>
  </section>

  <!-- Cards section: transparent wrapper over wave (only cards have bg) -->
  <section class="relative z-20 -mt-16 pt-12 md:-mt-24 md:pt-16 lg:-mt-56 lg:pt-20">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <div class="grid grid-cols-1 gap-8 md:grid-cols-3">
        <article class="rounded-xl bg-gradient-to-br from-teal-600 to-cyan-500 p-8 text-white shadow-xl transition-all duration-300 hover:-translate-y-1.5 hover:shadow-2xl">
          <p class="text-xs font-semibold uppercase tracking-wider text-white/90">CONSEJOS</p>
          <h2 class="mt-3 text-xl font-bold sm:text-2xl">Automatiza el cuidado de tu piscina</h2>
          <p class="mt-3 text-white/95">Sistemas y recomendaciones para un mantenimiento sencillo.</p>
        </article>
        <article class="rounded-xl bg-gradient-to-br from-teal-500 to-cyan-400 p-8 text-white shadow-xl transition-all duration-300 hover:-translate-y-1.5 hover:shadow-2xl">
          <p class="text-xs font-semibold uppercase tracking-wider text-white/90">SOLUCIONES</p>
          <h2 class="mt-3 text-xl font-bold sm:text-2xl">Tratamiento cloro y pH</h2>
          <p class="mt-3 text-white/95">Control automático del agua para mayor tranquilidad.</p>
        </article>
        <article class="rounded-xl bg-gradient-to-br from-cyan-600 to-teal-500 p-8 text-white shadow-xl transition-all duration-300 hover:-translate-y-1.5 hover:shadow-2xl">
          <p class="text-xs font-semibold uppercase tracking-wider text-white/90">PRODUCTOS</p>
          <h2 class="mt-3 text-xl font-bold sm:text-2xl">Cloro de alta pureza</h2>
          <p class="mt-3 text-white/95">Calidad profesional para un agua limpia y sin olores.</p>
        </article>
      </div>
      <!-- Left text + right horizontal image (reference layout) -->
      <section class="relative mt-24 overflow-hidden bg-white pt-16 md:mt-28 md:pt-20 lg:mt-32 lg:pt-24">
        <div class="grid grid-cols-1 items-center gap-10 lg:grid-cols-2 lg:gap-16">
          <div class="order-2 lg:order-1">
            <h2 class="text-3xl font-bold leading-tight tracking-tight text-slate-800 sm:text-4xl lg:text-5xl">
              Agua <span class="bg-gradient-to-r from-teal-500 to-cyan-500 bg-clip-text text-transparent">cristalina y pura</span> para quienes más te importan
            </h2>
            <p class="mt-6 max-w-xl text-base leading-relaxed text-slate-600 md:text-lg">
              Tratamiento profesional de piscinas con cloro de alta pureza y resultados visibles desde el primer uso.
            </p>
            <a href="#" class="mt-6 inline-flex items-center gap-2 rounded-lg border border-slate-200 bg-white px-5 py-2.5 text-base font-medium text-slate-700 shadow-sm transition-colors hover:bg-slate-50">
              Sobre PuriClor
              <span aria-hidden="true">→</span>
            </a>
          </div>
          <div class="order-1 lg:order-2">
            <div class="aspect-video w-full overflow-hidden rounded-lg bg-slate-200 shadow-md">
              <img src="../assets/lucid_screen.jpg" alt="Pool" class="h-full w-full object-cover" />
            </div>
          </div>
        </div>
        <div class="mx-auto mt-12 max-w-7xl border-t border-slate-200 pt-12 md:mt-16 md:pt-16"></div>
      </section>
    </div>
  </section>

  <!-- Brands: thin line, left text, right list, gradient into blue (connects to swimmer section below) -->
  <section class="relative overflow-hidden pt-0" style="background: linear-gradient(to bottom, #f8fafc 0%, #f0f9fc 35%, #e0f2f7 70%, #bae6fd 100%);">
    <div class="mx-auto max-w-7xl px-4 py-12 sm:px-6 lg:px-8 lg:py-16">
      <div class="grid grid-cols-1 gap-12 lg:grid-cols-2 lg:gap-20">
        <div>
          <h2 class="text-3xl font-bold tracking-tight sm:text-4xl" style="color: #1e3a5f;">Brands</h2>
          <p class="mt-5 max-w-xl text-base leading-relaxed text-slate-600 md:text-lg">
            Fluidra handles leading brands that are widely recognized in the sector and offers our customers a wide range of products in the pool and wellness market.
          </p>
          <a href="#" class="mt-6 inline-flex items-center gap-2 rounded-lg border border-slate-200 bg-slate-50/80 px-5 py-2.5 text-base font-medium text-slate-700 shadow-sm transition-colors hover:bg-slate-100">
            More about Brands
            <span aria-hidden="true">→</span>
          </a>
        </div>
      </div>
    </div>
    <div class="pointer-events-none absolute bottom-0 left-0 h-64 w-64 rounded-full opacity-30" style="background: radial-gradient(circle, #bae6fd 0%, transparent 70%);"></div>
  </section>

  <!-- Full-width gradient section (reference): white-to-blue, left swimmer, center text -->
  <section class="mb-20 relative isolate">
    <div class="relative flex min-h-[28rem] flex-col overflow-visible py-40 md:min-h-[70rem] md:pb-40 lg:min-h-[50rem] lg:pb-48" style="background: linear-gradient(to bottom, #bae6fd 0%, #7dd3fc 25%, #38bdf8 50%, #0ea5e9 70%, #2c8ea6 100%);">
      <div class="absolute left-[-1%] w-[40vw] max-w-[250px] pb-48">
        <img
          src="../assets/girl.png"
          alt="Nadadora"
          class="h-full w-full object-contain object-bottom"
        />
      </div>
      <div class="relative isolate z-10 order-2 flex min-h-[5rem] flex-1 flex-col justify-center px-6 md:px-10 lg:min-h-0 lg:flex-row lg:items-center lg:px-12">
        <div class="hidden shrink-0 lg:block lg:w-[32%]"></div>
        <div class="max-w-lg">
          <h2 class="text-2xl font-bold tracking-tight text-slate-800 md:text-3xl lg:text-4xl">
            Lorem ipsum dolor sit amet
          </h2>
          <p class="mt-5 text-base leading-relaxed text-slate-600 md:text-lg">
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
          </p>
        </div>
        <div class="hidden flex-1 lg:block"></div>
      </div>
      <div class="absolute bottom-0 left-0 w-full overflow-hidden">
        <svg
          viewBox="0 0 1440 320"
          class="w-full h-[260px]"
          preserveAspectRatio="none"
        >
          <path
            fill="white"
            d="
              M0,160
              C200,260 420,240 600,170
              C780,100 900,180 1040,260
              C1180,340 1320,320 1440,240
              L1440,320
              L0,320
              Z
            "
          />
        </svg>
      </div>
    </div>
  </section>

  <!-- Products section -->

  <section class="bg-white py-24">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <h2 class="text-center text-3xl font-bold tracking-tight text-slate-800 sm:text-4xl">Productos</h2>
      <p class="mx-auto mt-4 max-w-2xl text-center text-slate-600">Todo lo que necesitas para un agua cristalina y segura, con el respaldo de expertos.</p>
    </div>
  </section>

  <!-- Footer -->
  <footer class="bg-gradient-to-b from-teal-900 to-slate-900 text-white">
    <div class="mx-auto max-w-7xl px-4 py-20 sm:px-6 lg:px-8">
      <div class="grid grid-cols-1 gap-12 md:grid-cols-2 lg:grid-cols-3 lg:gap-16">
        <!-- Left: Contacto + social -->
        <div class="text-center lg:text-left">
          <h2 class="text-2xl font-bold tracking-tight">Contacto</h2>
          <p class="mt-3 max-w-sm text-white/80">
            Habla con un experto y recibe asesoría personalizada para el cuidado de tu piscina.
          </p>
          <div class="mt-6 flex justify-center gap-4 lg:justify-start">
            <a href="#" class="rounded-full p-2 text-white/80 transition-colors hover:text-white" aria-label="Facebook">
              <svg class="h-5 w-5" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
            </a>
            <a href="#" class="rounded-full p-2 text-white/80 transition-colors hover:text-white" aria-label="Instagram">
              <svg class="h-5 w-5" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.14 2.21 1.22 2.21 1.22-.31 1.59-.205 3.003-.205 3.003 1.407 1.438 2.31 2.234 2.31 2.234 1.918 1.918 4.18 1.918 5.62 0 1.918-1.918 1.918-4.18 0-5.62l-2.31-2.234s.105-1.413.205-3.003c.31-1.59-.205-2.21-2.21-2.21-1.59-.31-3.003-.205-3.003-.205-1.438-1.407-2.234-2.31-2.234-2.31-1.918-1.918-4.18-1.918-5.62 0-1.918 1.918-1.918 4.18 0 5.62l2.31 2.234s-1.413.105-3.003.205c-1.59.31-2.21.205-2.21 2.21.31 1.59.205 3.003.205 3.003-1.407 1.438-2.31 2.234-2.31 2.234-1.918 1.918-1.918 4.18 0 5.62 1.918 1.918 4.18 1.918 5.62 0l2.234-2.31s.105-1.413-.205-3.003c-.31-1.59.205-2.21 2.21-2.21 1.59-.31 3.003-.205 3.003-.205 1.438 1.407 2.234 2.31 2.234 2.31 1.918 1.918 4.18 1.918 5.62 0 1.918-1.918 1.918-4.18 0-5.62l-2.234-2.31zM12 7.163c-2.67 0-4.837 2.165-4.837 4.837 0 2.67 2.165 4.837 4.837 4.837 2.67 0 4.837-2.165 4.837-4.837 0-2.67-2.165-4.837-4.837-4.837z"/></svg>
            </a>
          </div>
        </div>
        <!-- Center: Form -->
        <div class="lg:col-span-1">
          <form class="space-y-4">
            <div>
              <label for="footer-name" class="sr-only">Nombre completo</label>
              <input type="text" id="footer-name" name="nombre" placeholder="Nombre completo" class="w-full rounded-lg border border-white/20 bg-white/5 px-4 py-3 text-white placeholder-white/50 focus:border-cyan-400 focus:outline-none focus:ring-2 focus:ring-cyan-400/50" />
            </div>
            <button type="submit" class="w-full rounded-full bg-cyan-500 px-6 py-3 font-medium text-white shadow-lg transition-all duration-300 hover:bg-cyan-400 hover:shadow-xl focus:outline-none focus:ring-2 focus:ring-cyan-400 focus:ring-offset-2 focus:ring-offset-teal-900">
              Enviar consulta
            </button>
          </form>
        </div>
        <!-- Right: Teléfono + Email -->
        <div class="text-center lg:text-left">
          <p class="text-xs font-semibold uppercase tracking-wider text-white/60">Teléfono</p>
          <p class="mt-1 text-white"><a href="tel:+573182424723" class="hover:text-cyan-300 transition-colors">+57 318 242 4723</a></p>
          <p class="mt-6 text-xs font-semibold uppercase tracking-wider text-white/60">Email</p>
          <p class="mt-1 text-white"><a href="mailto:puriclor@puriclor.com" class="hover:text-cyan-300 transition-colors">puriclor@puriclor.com</a></p>
        </div>
      </div>
    </div>
    <div class="border-t border-white/10">
      <div class="mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8">
        <p class="text-center text-sm text-white/60">© 2025 PuriClor. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <script type="module">
    (async function() {
      let THREE, GLTFLoader;
      try {
        const threeMod = await import('https://esm.sh/three@0.160.0');
        THREE = threeMod.default || threeMod;
        const loaderMod = await import('https://esm.sh/three@0.160.0/examples/jsm/loaders/GLTFLoader.js');
        GLTFLoader = loaderMod.GLTFLoader;
      } catch (e) {
        console.error('[hero-3d] Failed to load Three.js:', e);
        return;
      }

      const container = document.getElementById('hero-3d');
    if (!container) {
      console.error('[hero-3d] Container #hero-3d not found');
      throw new Error('hero-3d container not found');
    }
    function getSize() {
      const w = Math.max(container.clientWidth || 300, 300);
      const h = Math.max(container.clientHeight || 300, 300);
      return { w, h };
    }

    const scene = new THREE.Scene();
    const { w: initW, h: initH } = getSize();

    const camera = new THREE.PerspectiveCamera(45, initW / initH, 0.1, 1000);
    camera.position.set(0, 0, 5);
    camera.lookAt(0, 0, 0);

    const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
    renderer.setSize(initW, initH);
    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
    renderer.domElement.style.display = 'block';
    container.appendChild(renderer.domElement);

    // Hero product lighting: key, rim, fill, env
    const ambientLight = new THREE.AmbientLight(0xffffff, 0.35);
    scene.add(ambientLight);
    const hemisphere = new THREE.HemisphereLight(0xe8f4fc, 0x6b8a9e, 0.4);
    scene.add(hemisphere);
    const keyLight = new THREE.DirectionalLight(0xffffff, 0.9);
    keyLight.position.set(2, 4, 5);
    scene.add(keyLight);
    const rimLight = new THREE.DirectionalLight(0xffffff, 0.6);
    rimLight.position.set(-3, 2, -4);
    scene.add(rimLight);
    const fillLight = new THREE.DirectionalLight(0xffffff, 0.35);
    fillLight.position.set(-1.5, 0, 2);
    scene.add(fillLight);

    let model = null;
    let modelLoadTime = null;

    const clock = new THREE.Clock();
    const FLOAT_PERIOD_Y = 6;
    const FLOAT_AMP_Y = 0.022;
    const DRIFT_PERIOD_X = 11;
    const DRIFT_AMP_X = 0.080;
    const MICRO_Y_PERIOD = 12;
    const MICRO_Y_AMP = 0.028;
    const MICRO_Z_PERIOD = 10;
    const MICRO_Z_AMP = 0.016;
    const BASE_ROT_Y = (54 * Math.PI) / 180;
    const BASE_ROT_Z = (-22 * Math.PI) / 180;
    const BASE_ROT_X = (18 * Math.PI) / 180;

    const RISE_DURATION = 2.4;
    const RISE_START_Y = -0.28;

    function animate() {
      requestAnimationFrame(animate);
      const now = clock.getElapsedTime();
      if (model) {
        const t = now;
        let baseY = 0;
        if (modelLoadTime != null) {
          const riseProgress = Math.min((t - modelLoadTime) / RISE_DURATION, 1);
          const ease = riseProgress * riseProgress * (3 - 2 * riseProgress);
          baseY = RISE_START_Y + (0 - RISE_START_Y) * ease;
        }
        const floatY = Math.sin((t * Math.PI * 2) / FLOAT_PERIOD_Y) * FLOAT_AMP_Y;
        model.position.y = baseY + floatY;
        model.position.x = Math.sin((t * Math.PI * 2) / DRIFT_PERIOD_X) * DRIFT_AMP_X;
        model.rotation.x = BASE_ROT_X;
        model.rotation.y = BASE_ROT_Y + Math.sin((t * Math.PI * 2) / MICRO_Y_PERIOD) * MICRO_Y_AMP;
        model.rotation.z = BASE_ROT_Z + Math.sin((t * Math.PI * 2) / MICRO_Z_PERIOD) * -MICRO_Z_AMP;
      }
      renderer.render(scene, camera);
    }
    animate();

    const modelPath = new URL('../models/puriclor-bottle.glb', import.meta.url).href;

    const loader = new GLTFLoader();
    loader.load(
      modelPath,
      (gltf) => {
        model = gltf.scene;

        function applyMaterialFlags(m) {
          m.side = THREE.DoubleSide;
          m.depthWrite = true;
          m.needsUpdate = true;
        }

        model.traverse((child) => {
          if (child.isMesh) {
            child.visible = true;
            child.frustumCulled = false;
            if (child.material) {
              const m = child.material;
              if (Array.isArray(m)) m.forEach(applyMaterialFlags);
              else applyMaterialFlags(m);
            }
          }
        });

        if (model.scale.x === 0 && model.scale.y === 0 && model.scale.z === 0) {
          model.scale.setScalar(1);
        }

        scene.add(model);
        model.updateMatrixWorld(true);

        const box = new THREE.Box3().setFromObject(model);
        const center = new THREE.Vector3();
        box.getCenter(center);
        model.position.sub(center);
        model.updateMatrixWorld(true);

        let box2 = new THREE.Box3().setFromObject(model);
        const sphere = new THREE.Sphere();
        box2.getBoundingSphere(sphere);
        let radius = sphere.radius;

        const fovRad = (camera.fov * Math.PI) / 180;
        const heroHeightFraction = 0.35;
        const normalizedRadius = 1;
        const scaleFactor = normalizedRadius / Math.max(radius, 0.01);
        model.scale.multiplyScalar(scaleFactor);
        model.updateMatrixWorld(true);

        box2 = new THREE.Box3().setFromObject(model);
        box2.getBoundingSphere(sphere);
        radius = sphere.radius;

        const safeRadius = Math.max(radius, 0.01);
        const distance = safeRadius / (Math.tan(fovRad / 2) * heroHeightFraction);
        const camDist = Math.max(distance, 0.5);
        camera.position.set(0, 0, camDist);
        camera.lookAt(0, 0, 0);
        camera.near = Math.max(0.001, camDist - safeRadius - 1);
        camera.far = Math.max(camera.near + 1, camDist + safeRadius + 100);
        camera.updateProjectionMatrix();

        const size2 = new THREE.Vector3();
        box2.getSize(size2);
        const shadowGeo = new THREE.PlaneGeometry(1, 1);
        const shadowMat = new THREE.MeshBasicMaterial({
          color: 0x0a0a0a,
          transparent: true,
          opacity: 0.14,
          depthWrite: false,
          side: THREE.DoubleSide
        });
        const shadowPlane = new THREE.Mesh(shadowGeo, shadowMat);
        shadowPlane.rotation.x = -Math.PI / 2;
        shadowPlane.rotation.z = 0.04;
        shadowPlane.position.set(0, -size2.y / 2 - 0.008, 0);
        shadowPlane.scale.set(2.6, 1, 1.5);
        model.add(shadowPlane);

        modelLoadTime = clock.getElapsedTime();
      },
      undefined,
      (err) => {
        console.error('[hero-3d] GLB load failed:', err);
      }
    );

    function onResize() {
      const { w, h } = getSize();
      camera.aspect = w / h;
      camera.updateProjectionMatrix();
      renderer.setSize(w, h);
    }
    window.addEventListener('resize', onResize);
    const ro = new ResizeObserver(onResize);
    ro.observe(container);
    })();
  </script>
</body>
</html>
